{
	"info": {
		"_postman_id": "6f16adc9-62eb-4135-aaae-cc0142adf636",
		"name": "Postman_HW_3*",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "currency",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var My_array = pm.response.json();\r",
							"var passArr = [];\r",
							"var failArr = [];\r",
							"var count = 0;\r",
							"\r",
							"for (var i = 0; i < My_array.length; i++){\r",
							"    \r",
							"    pm.sendRequest({\r",
							"        \r",
							"        url: \"http://162.55.220.72:5005/curr_byn\", \r",
							"        method: 'POST',\r",
							"        header: {\r",
							"            'Accept': 'application/json',\r",
							"            'Content-Type': 'application/x-www-form-urlencoded'\r",
							"        },\r",
							"        body: {\r",
							"            mode: 'formdata',\r",
							"            formdata: [\r",
							"                {key: \"auth_token\", value: pm.environment.get(\"token\"), disabled: false},\r",
							"                {key: \"curr_code\", value: My_array[i].Cur_ID, disabled: false},\r",
							"            ]\r",
							"        }\r",
							"    },\r",
							"\r",
							"    function (err, res) {\r",
							"        \r",
							"        count += 1;        \r",
							"\r",
							"        if (res.code==200) {\r",
							"            JS_data = res.json();\r",
							"            passArr.push(JS_data);\r",
							"        }\r",
							"        else {\r",
							"            failArr.push(My_array[count])\r",
							"        }\r",
							"\r",
							"    //---Закончили слать реквесты и проходим по нашим массивам\r",
							"    if (count == My_array.length) {\r",
							"        \r",
							"        console.log(\"===START===\");\r",
							"        \r",
							"        //+Сортировка массива\r",
							"        failArr.sort(function(a, b){\r",
							"            return a.Cur_ID-b.Cur_ID\r",
							"        })        \r",
							"        \r",
							"        passArr.sort(function(a, b){\r",
							"             return a.Cur_ID-b.Cur_ID\r",
							"        })        \r",
							"        //-\r",
							"\r",
							"        //+Выводим массив по не найденным курсам\r",
							"        console.log(\"Не найдено курсов валют -\", failArr.length)\r",
							"        for (var i = 0; i < failArr.length; i++) {\r",
							"            console.log(\"№\", i+1, \"Cur_ID=\", failArr[i].Cur_ID, \"Cur_Abbreviation=\", failArr[i].Cur_Abbreviation, \"Cur_Name=\", failArr[i].Cur_Name)\r",
							"        }\r",
							"        //-\r",
							"\r",
							"        //+Выводим массив с найденными курсами\r",
							"        console.log(\"Найдено курсов валют -\", passArr.length)\r",
							"        for (var i = 0; i < passArr.length; i++) {\r",
							"            console.log(\"№\", i+1, \"Cur_ID=\", passArr[i].Cur_ID, \"Cur_Abbreviation=\", passArr[i].Cur_Abbreviation, \"Cur_Name=\", passArr[i].Cur_Name, \"Cur_OfficialRate=\", passArr[i].Cur_OfficialRate, \"Cur_Scale=\", passArr[i].Cur_Scale, \"Date cur=\", passArr[i].Date)\r",
							"        }        \r",
							"        //-\r",
							"        console.log(\"===FINISH===\")\r",
							"    }\r",
							"    });\r",
							"}"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "auth_token",
							"value": "{{token}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{url}}/currency",
					"host": [
						"{{url}}"
					],
					"path": [
						"currency"
					]
				}
			},
			"response": []
		}
	]
}
